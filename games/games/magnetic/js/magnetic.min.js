Magnetic=new (function(){function y(a){var b=new Magnet;b.position.x=a.x;b.position.y=a.y;e.push(b);a=b.position;for(b=0;b<E;b++){var c=new Particle;c.position.x=a.x;c.position.y=a.y;c.shift.x=a.x;c.shift.y=a.y;c.color=k[f].particleFill;q.push(c)}}function F(a){n=a.clientX-(window.innerWidth-i)*0.5;o=a.clientY-(window.innerHeight-j)*0.5}function G(a){a.preventDefault();z()}function z(){v=true;if((new Date).getTime()-w<300){y({x:n,y:o});w=0}w=(new Date).getTime();for(var a=0,b=e.length;a<b;a++){magnet=
e[a];if(A(magnet.position,{x:n,y:o})<magnet.orbit*0.5){magnet.dragging=true;break}}}function H(){v=false;for(var a=0,b=e.length;a<b;a++){magnet=e[a];magnet.dragging=false}}function I(a){if(a.keyCode==37)s(-1);else a.keyCode==39&&s(1)}function J(a){if(a.touches.length==1){a.preventDefault();n=a.touches[0].pageX-(window.innerWidth-i)*0.5;o=a.touches[0].pageY-(window.innerHeight-j)*0.5;z()}}function K(a){if(a.touches.length==1){a.preventDefault();n=a.touches[0].pageX-(window.innerWidth-i)*0.5;o=a.touches[0].pageY-
(window.innerHeight-j)*0.5}}function L(){v=false;for(var a=0,b=e.length;a<b;a++){magnet=e[a];magnet.dragging=false}}function M(a){a.preventDefault();s(-1)}function N(a){a.preventDefault();s(1)}function s(a){f+=a;f=f<0?k.length-1:f;f=f>k.length-1?0:f;a=0;for(var b=q.length;a<b;a++)q[a].color=k[f].particleFill}function B(){i=r?window.innerWidth:1E3;j=r?window.innerHeight:550;g.width=i;g.height=j;var a=(window.innerWidth-i)*0.5,b=(window.innerHeight-j)*0.5;g.style.position="absolute";g.style.left=a+
"px";g.style.top=b+"px"}function O(){if(k[f].useFade){d.fillStyle=k[f].fadeFill;d.fillRect(0,0,d.canvas.width,d.canvas.height)}else d.clearRect(0,0,g.width,g.height);var a,b,c,h,C,t;a=-1;h=0;for(t=e.length;h<t;h++){b=e[h];if(b.dragging){b.position.x+=(n-b.position.x)*0.2;b.position.y+=(o-b.position.y)*0.2}else if(b.position.x<0||b.position.y<0||b.position.x>i||b.position.y>j)a=h;b.size+=(b.connections/3-b.size)*0.05;b.size=Math.max(b.size,2);c=d.createRadialGradient(b.position.x,b.position.y,0,b.position.x,
b.position.y,b.size*10);c.addColorStop(0,k[f].glowA);c.addColorStop(1,k[f].glowB);d.beginPath();d.fillStyle=c;d.arc(b.position.x,b.position.y,b.size*10,0,Math.PI*2,true);d.fill();d.beginPath();d.fillStyle=c;d.arc(b.position.x,b.position.y,b.size,0,Math.PI*2,true);d.fill();b.connections=0}a!=-1&&e.length>1&&e.splice(a,1);c=0;for(C=q.length;c<C;c++){a=q[c];var x=-1,D=-1,l=null,u={x:0,y:0};h=0;for(t=e.length;h<t;h++){b=e[h];x=A(a.position,b.position)-b.orbit*0.5;if(a.magnet!=b){var m=b.position.x-a.position.x;
if(m>-p&&m<p)u.x+=m/p;m=b.position.y-a.position.y;if(m>-p&&m<p)u.y+=m/p}if(l==null||x<D){D=x;l=b}}if(a.magnet==null||a.magnet!=l)a.magnet=l;l.connections+=1;a.angle+=a.speed*a.direction;a.shift.x+=(l.position.x+u.x*6-a.shift.x)*a.speed;a.shift.y+=(l.position.y+u.y*6-a.shift.y)*a.speed;a.position.x=a.shift.x+Math.cos(c+a.angle)*a.orbit*a.force;a.position.y=a.shift.y+Math.sin(c+a.angle)*a.orbit*a.force;a.position.x=Math.max(Math.min(a.position.x,i-a.size/2),a.size/2);a.position.y=Math.max(Math.min(a.position.y,
j-a.size/2),a.size/2);a.orbit+=(l.orbit-a.orbit)*0.1;d.beginPath();d.fillStyle=a.color;d.arc(a.position.x,a.position.y,a.size/2,0,Math.PI*2,true);d.fill()}}function A(a,b){var c=b.x-a.x,h=b.y-a.y;return Math.sqrt(c*c+h*h)}var r=navigator.userAgent.toLowerCase().indexOf("android")!=-1||navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("ipad")!=-1,i=r?window.innerWidth:1E3,j=r?window.innerHeight:550,E=20,p=300,g,d,q=[],e=[],n=window.innerWidth-i,o=window.innerHeight-
j,v=false,w=0,f=0,k=[{glowA:"rgba(233,143,154,0.3)",glowB:"rgba(0,143,154,0.0)",particleFill:"#ffffff",fadeFill:"rgba(22,22,22,.6)",useFade:false},{glowA:"rgba(0,200,250,0.3)",glowB:"rgba(0,200,250,0.0)",particleFill:"#ffffff",fadeFill:"rgba(22,22,22,.6)",useFade:true},{glowA:"rgba(230,0,0,0.3)",glowB:"rgba(230,0,0,0.0)",particleFill:"#ffffff",fadeFill:"rgba(11,11,11,.6)",useFade:true},{glowA:"rgba(0,230,0,0.3)",glowB:"rgba(0,230,0,0.0)",particleFill:"rgba(0,230,0,0.7)",fadeFill:"rgba(22,22,22,.6)",
useFade:true},{glowA:"rgba(0,0,0,0.3)",glowB:"rgba(0,0,0,0.0)",particleFill:"#333333",fadeFill:"rgba(255,255,255,.6)",useFade:true},{glowA:"rgba(0,0,0,0.0)",glowB:"rgba(0,0,0,0.0)",particleFill:"#333333",fadeFill:"rgba(255,255,255,.2)",useFade:true},{glowA:"rgba(230,230,230,0)",glowB:"rgba(230,230,230,0.0)",particleFill:"#ffffff",fadeFill:"",useFade:false}];this.init=function(){if((g=document.getElementById("world"))&&g.getContext){d=g.getContext("2d");if(r)g.style.border="none";document.addEventListener("mousemove",
F,false);g.addEventListener("mousedown",G,false);document.addEventListener("mouseup",H,false);document.addEventListener("keydown",I,false);window.addEventListener("resize",B,false);g.addEventListener("touchstart",J,false);document.addEventListener("touchmove",K,false);document.addEventListener("touchend",L,false);document.getElementById("keyboardLeft").addEventListener("click",M,false);document.getElementById("keyboardRight").addEventListener("click",N,false);for(var a=0;a<4;a++)y({x:(i-300)*0.5+
Math.random()*300,y:(j-300)*0.5+Math.random()*300});B();setInterval(O,1E3/30)}}});function Particle(){this.size=0.5+Math.random()*3.5;this.position={x:0,y:0};this.shift={x:0,y:0};this.angle=0;this.speed=0.01+this.size/4*0.03;this.force=1-Math.random()*0.11;this.color="#ffffff";this.orbit=1;this.magnet=null;this.direction=Math.random()>0.5?-1:1}function Magnet(){this.orbit=100;this.position={x:0,y:0};this.dragging=false;this.connections=0;this.size=1}Magnetic.init();